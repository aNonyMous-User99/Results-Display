%                                        Line code 
%         Bus bus   R       Xl     1/2 Bc   = 1 for lines
%         nl  nr  p.u.   p.u.   p.u.     > 1 or < 1 tr. tap at bus nl
Data_Line=[1   2   0.0022     0.0407   0.0   1;
           2   3   0.0030     0.0511   0.0   1;
           3   4   0.0160     0.0164   0.0   1;
           4   5   0.0011     0.0141   0.0   1;
           5   6   0.0190     0.0070   0.0   1;
           6   7   0.0172     0.0188   0.0   1;
           7   8   0.0144     0.0351   0.0   1;
           8   9   0.0300     0.0400   0.0   1;
           9  10   0.0440     0.0400   0.0   1;
          10  11   0.0066     0.0150   0.0   1;
          11  12   0.0344     0.0238   0.0   1;
          12  13   0.0180     0.0550   0.0   1;
          13  14   0.0416     0.0129   0.0   1;
          14  15   0.0010     0.0260   0.0   1;
          15  16   0.0463     0.0450   0.0   1;
          16  17   0.0190     0.0210   0.0   1;
          17  18   0.0320     0.0140   0.0   1;
           2  19   0.0640     0.0365   0.0   1;
          19  20   0.0042     0.0354   0.0   1;
          20  21   0.0095     0.0284   0.0   1;
          21  22   0.0089     0.0373   0.0   1;
           3  23   0.0512     0.0083   0.0   1;
          23  24   0.0080     0.0091   0.0   1;
          24  25   0.0060     0.0011   0.0   1;
           6  26   0.0030     0.0034   0.0   1;
          26  27   0.0042     0.0447   0.0   1;
          27  28   0.0090     0.0337   0.0   1;
          28  29   0.0042     0.0006   0.0   1;
          29  30   0.0075     0.0585   0.0   1;
          30  31   0.0744     0.0630   0.0   1;
          31  32   0.0105     0.0619   0.0   1;
          32  33   0.0410     0.0302   0.0   1;
           8  21   0.0200     0.0200   0.0   1;
           9  15   0.0200     0.0200   0.0   1;
          12  22   0.0200     0.0200   0.0   1;
          18  33   0.0050     0.0050   0.0   1;
          25  29   0.0050     0.0050   0.0   1;
           ];



%         Bus Bus  Voltage Angle   ---Load---- -------Generator----- 
%         No code  Mag.   Degree   W     var   P*     Q*    Pmin  Pmax    Qmin   Qmax 
%          1   2     3      4      5      6     7     8      9    10      11     12
%Busdata3=[1   1    220    0.0   0.0     0.0   33000  9000  0.0   66000  -18000 18000;
%          2   2    220    0.0   12000   0.0   0.0    0.0   0.0   0.0    0.0    0.0 ];
Data_Bus_Nominal  =[1   1    220    0.0   0.0    0.0   22000  3000    0.0   44000  -6000  6000; 
            2   2    220    0.0   1000   1000  0.0     0.0    0.0   0.0     0.0     0.0;
            3   2    220    0.0   2400   2000  0.0     0.0    0.0   0.0     0.0     0.0;
            4   2    220    0.0   6800   800   0.0     0.0    0.0   0.0     0.0     0.0;
            5   2    220    0.0   4000   800   0.0     0.0    0.0   0.0     0.0     0.0;
            6   2    220    0.0   2000   800   0.0     0.0    0.0   0.0     0.0     0.0;
            7   2    220    0.0   8000   1000  0.0     0.0    0.0   0.0     0.0     0.0;
            8   1    220    0.0   0.0    0.0   11000  3000    0.0   22000  -6000  6000;
            9   2    220    0.0   1400   600   0.0     0.0    0.0   0.0     0.0     0.0;
           10   2    220    0.0   2400   600   0.0     0.0    0.0   0.0     0.0     0.0;
           11   2    220    0.0   8000   900   0.0     0.0    0.0   0.0     0.0     0.0;
           12   1    220    0.0   0.0    0.0   11000  3000    0.0   22000  -6000  6000;
           13   2    220    0.0   4000   700   0.0     0.0    0.0   0.0     0.0     0.0;
           14   2    220    0.0   4800   800   0.0     0.0    0.0   0.0     0.0     0.0;
           15   1    220    0.0   0.0    0.0   11000  3000    0.0   22000  -6000  6000;
           16   2    220    0.0   2400   1000  0.0     0.0    0.0   0.0     0.0     0.0;
           17   2    220    0.0   2000   1000  0.0     0.0    0.0   0.0     0.0     0.0;
           18   2    220    0.0   3600   900   0.0     0.0    0.0   0.0     0.0     0.0;
           19   1    220    0.0   0.0    0.0   11000  3000    0.0   22000  -6000  6000;
           20   2    220    0.0   3600   900   0.0     0.0    0.0   0.0     0.0     0.0;
           21   2    220    0.0   3600   800   0.0     0.0    0.0   0.0     0.0     0.0;
           22   2    220    0.0   3600   700   0.0     0.0    0.0   0.0     0.0     0.0;
           23   1    220    0.0   0.0    0.0   11000  3000    0.0   22000  -6000  6000;
           24   2    220    0.0   6800   2000  0.0     0.0    0.0   0.0     0.0     0.0;
           25   2    220    0.0   6800   2000  0.0     0.0    0.0   0.0     0.0     0.0;
           26   1    220    0.0   0.0    0.0   11000  3000    0.0   22000  -6000  6000;
           27   2    220    0.0   2400   2500  0.0     0.0    0.0   0.0     0.0     0.0;
           28   2    220    0.0   2400   250   0.0     0.0    0.0   0.0     0.0     0.0;
           29   2    220    0.0   4800   700   0.0     0.0    0.0   0.0     0.0     0.0;
           30   2    220    0.0   8000   600   0.0     0.0    0.0   0.0     0.0     0.0;
           31   2    220    0.0   6000   700   0.0     0.0    0.0   0.0     0.0     0.0;
           32   2    220    0.0   8400   1000  0.0     0.0    0.0   0.0     0.0     0.0;
           33   1    220    0.0   0.0    0.0   11000  3000    0.0   22000  -6000  6000;
            ]; 


Freq_base = 50;
V_base = 220;
W_base = 2*pi*Freq_base;
% Droop_m_w = 4.5e-5*2*pi;
% Droop_n_V = 3e-3;

%        No. m_f   n_V    Kvp    Kvi  Kip Kii  Udc wc R    L    C     Kpwm     P*    Q* 
%        1   2     3      4      5    6   7    8   9  10   11    12    13      14    15
% DGdata3=[1  1.5e-5  6e-4 0.2013 480 6.72 3360 800 31.4 0.1 2e-4 4e-5 0.4969 33000 9000;
%         ];
Data_DG =  [1  2.25e-5 1.8e-4 0.2013 480 6.72 3360 800 31.4 0.1 2e-4 4e-5  1  22000 3000;
            8  4.5e-5  1.8e-4 0.2013 480 6.72 3360 800 31.4 0.1 2e-4 4e-5  1  11000 3000;
           12  4.5e-5  1.8e-4 0.2013 480 6.72 3360 800 31.4 0.1 2e-4 4e-5  1  11000 3000;
           15  4.5e-5  1.8e-4 0.2013 480 6.72 3360 800 31.4 0.1 2e-4 4e-5  1  11000 3000;
           19  4.5e-5  1.8e-4 0.2013 480 6.72 3360 800 31.4 0.1 2e-4 4e-5  1  11000 3000;
           23  4.5e-5  1.8e-4 0.2013 480 6.72 3360 800 31.4 0.1 2e-4 4e-5  1  11000 3000;
           26  4.5e-5  1.8e-4 0.2013 480 6.72 3360 800 31.4 0.1 2e-4 4e-5  1  11000 3000;
           33  4.5e-5  1.8e-4 0.2013 480 6.72 3360 800 31.4 0.1 2e-4 4e-5  1  11000 3000;
        ];

%            Physical index Cyber index
Data_Trans = [ 1    1 ;
               8    2 ;
              12    3 ;
              15    4 ;
              19    5 ;
              23    6 ;
              26    7 ;
              33    8
               ];
         
    
% Cyber network topology based on physical index
% Laplace = [1 -1;-1 1];
Adjace = [  0 -1 -1  0  0  0  0 -1;
           -1  0 -1 -1  0  0  0  0;
           -1 -1  0 -1  0  0  0  0;
            0 -1 -1  0 -1  0  0  0;
            0  0  0 -1  0 -1 -1  0;
            0  0  0  0 -1  0 -1 -1;
            0  0  0  0 -1 -1  0 -1;
           -1  0  0  0  0 -1 -1  0;];
Diag_L = diag(sum(Adjace));
Laplace = Adjace - Diag_L;

%cyber network index
Cyber_net=[1 2
    1 3
    1 7
    1 8
    2 3
    2 4
    2 7
    3 4
    3 5
    4 5
    5 6
    5 7
    6 7
    6 8
    7 8
    2 1
    3 1
    8 1
    3 2
    4 2
    4 3
    5 3
    5 4
    6 5
    7 1
    7 2
    7 5
    7 6
    8 6
    8 7];